---
title: "Debian: bugs.debian.orgにない機能を実装して運用しはじめた話"
emoji: "🪔"
type: "tech"
topics: ["Debian"]
published: false
---

# fabre.debian.netの開発の進め方と運用、得た学びの話

これは「個人アプリ/サービス開発の進め方と運用、得た学び - 02」の19日目の記事です。

## fabre.debian.netとは

Debianのバグトラッキングシステムは https://bugs.debian.org が使われています。
とても歴史のあるバグトラッキングシステムでシンプルなのですが、ちょっと使い勝手に難があります。
自分が欲しい機能をフィードバックするにはには時間がかかりそうなので、自分が欲しいサービスを実験的に立ち上げてみました。

* https://fabre.debian.net

debian.netなのであくまで非公式なサービスです。ある日突然畳むことがあるかもしれません。

* [An experiment about personalized front-end of bugs.debian.org](https://slide.rabbit-shocker.org/authors/kenhys/debconf2020-online/)

fabre.debian.netで何を目指したのかについては、上記のスライドを参照してください。
ざっくりいうと、影響を受けるバグは把握しておきたいし、使っているパッケージに問題があるならフィードバックしたい。
でも、bugs.debian.orgでそれを自分が思うようにやるにはちょっとつらい。
そのあたりを自分にとっていい感じに扱えるようにしたい、というのが開発の動機です。

## サービス開発の進め方と運用

自分のために開発したサービスなので、使っていて欲しくなった機能から順番に実装しています。思いつき駆動です。

* 欲しい機能やあったらいいかもな機能についてRedmineにチケットを立てておく
* 気が向いたらちまちま実装する
* 動作確認をしてfabre.debian.netにデプロイする

ちゃんとしたサービスなら開発系、検証系、本番と段取りを踏むのでしょうが、個人開発なので
いろいろすっ飛ばしています。あくまで趣味でやっていることなのでそんなもんです。

### サービス開発の進め方と運用で得た教訓

普段Webサービスの開発をもっぱらやっているわけではないので、実際に手を動かしてみると、多くの教訓を得ました。
とはいっても、よくある基本的な事柄ばかりです。

* どんなにマイナーだろうがアタックはされる

インスタンスを立ち上げたときから、sshでログインしようと試みてきます。
きっちり公開鍵のみにアクセスをしぼりましょう。

* しつこい輩はbanする

何度もアタックをしかけてくるパターンについてはfail2banとかでガードしましょう。

* アクセス可能なポートを制限する

F/Wとかデフォルトでついているサービスもありますが、ufwとかでアクセス可能なポートはしめておきましょう。

* 定期的にリソースの使用状況を確認する

別に落ちたらそれまでのサービスですが、定期的にリソースは確認しましょう。
リソース監視系のサービスとか世の中にいっぱいありますが、collectdについてくるcollection3とかでもシンプルでよいです。
リソースの都合で今は一緒のサーバーで動かしてみますが、そのうちこれはわけるべきですね。

1vCPU 1GBメモリのインスタンスだと、使っているのが自分一人とはいえ、メモリがやっぱり厳しいですね。
バッチを一緒にぶんまわしたら、インスタンスごと死にました。そういったのも、しっかりグラフの結果にでてきます。

* 使っていないサービスは無効化する

インスタンスの初期イメージがUbuntuだったのでそれを更新して使っているのですが、使っていないサービスはsystemctl disableできっちり止めておきましょう。
貧弱なサーバーリソースだと無駄なサービスは大敵です。

* フロントエンドのキャッシュを効かせる

一定のパターンのアクセスが多い場合には、nginxのキャッシュをチューニングするとよいです。

* なんでもかんでもAWSにのっければよいわけではない

ふと思い立って t2.micro のインスタンスに乗っけてみたことがありますが、CPUクレジットの制限が厳しくて断念しました。
試行錯誤しつつCPUをぶんまわしている段階では、まだ早かったです。
そういうことは別のインスタンスでやるか、ある程度実装がこなれてからやるべきですね。

### 今後の課題

最近更新されたバグなんかはいい感じにリストアップできるようになってきたので、
次はいい感じの全文検索を実装しようとしています。
1vCPUのインスタンスなので、負荷を抑えつつどこまでできるかは


### まとめ

fabre.debian.netの開発の進め方と運用、得た学びの話について書きました。
20日目は「skillfuls.devについてなにか書きます！」だそうです。
